<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>main</title>
</head>



<body>
<div><h1 style="align-content: center; text-align: center; ">비디오 스트리밍</h1></div>
<div style="align-content: end">
<a href="api/v1/upload/uploadPage">업로드</a>
<a href="api/v1/stream/streamPage">스트리밍 시작</a>
<a id="loginBtn"></a>
<p id="hi"></p>

</div>

<div style="float: left; width: 45%" >
    <h1>동영상</h1>
    <div th:each="video : ${videoList}">
        <a th:href="${'detail/'+ video.url}">
        <div style="align-content: center;">

                <img th:src="${video.thumbNailUrl}" width="50%" style="border-radius: 5%">
                <p th:text="${video.title}" style="width: 50%; font-size: larger"></p>
        </div>
        </a>
    </div>
</div>

<div style="float: right; width: 45%" >
    <h1>스트리밍</h1>
    <div th:each="video : ${streamList}" >
        <a th:href="${'detail/live/'+ video.streamKey}">
        <div style="align-content: center;">
<!--            <img th:src="${video.thumbNailUrl}" width="50%" style="border-radius: 5%">-->
                <p th:text="${video.title}" style="width: 50%; font-size: larger"></p>
        </div>
        </a>
    </div>
</div>


<script>
    history.replaceState({},document.title,window.location.pathname)
    let user= "[[${user}]]"
    if( user !=="null"){
        localStorage.setItem("jwt","[[${jwt}]]")
        localStorage.setItem("name",user)
    }

    let jwt
    let userName
    let hi = document.getElementById("loginBtn")
    console.log(localStorage.getItem("jwt"))
    if(localStorage.getItem("jwt")!==null){
        console.log("안녕")
        jwt = localStorage.getItem("jwt")
        userName = localStorage.getItem("name")
        hi.textContent = userName + "님 안녕하세요"
    } else{
        console.log("로그인")
        jwt = null
        let loginBtn = document.getElementById("loginBtn")
        console.log(loginBtn)
        loginBtn.href = "/oauth2/authorization/google"
        loginBtn.textContent ="구글 로그인"
    }
</script>

</body>
</html>